{"title":"重学sqlserver一遍","slug":"重学sqlserver一遍","date":"2019-09-02T17:26:27.829Z","updated":"2019-09-02T17:26:27.842Z","comments":true,"path":"api/articles/重学sqlserver一遍.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<p>安装软件<br>1.数据库 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">什么是数据库</span><br><span class=\"line\">   侠义  存储数据的仓库</span><br><span class=\"line\">广义：</span><br><span class=\"line\">        可以对数据进行存储或管理的软件     以及   数据本身 统称为数据库</span><br><span class=\"line\"> 数据库是由 表 、关系 、 操作组成</span><br><span class=\"line\">为什么需要数据库</span><br><span class=\"line\">        网站后台的应用软件都需要数据库</span><br><span class=\"line\">        数据库的占用空间小 容易持久保存</span><br><span class=\"line\">        存储比较安全</span><br><span class=\"line\">        容易维护和安全</span><br><span class=\"line\">        数据库移植比较容易</span><br><span class=\"line\">        简化对数据的操作</span><br><span class=\"line\">数据库的安装和卸载</span><br><span class=\"line\">          数据库  安装 最好以管理员运行 cmd</span><br><span class=\"line\">           安装过程中遇见： 计算机重启失败 ；</span><br><span class=\"line\">            解决办法：1、在开始-&gt;运行中输入regedit（注册表编辑器）</span><br><span class=\"line\">                            2、到HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\</span><br><span class=\"line\">                            3、在右边窗口右击PendingFileRenameOperations，选择删除，然后确认</span><br><span class=\"line\">        预备知识：</span><br><span class=\"line\">数据结构和数据库的区别</span><br><span class=\"line\">        数据库是在应用软件级别研究数据的存储和操作  硬盘</span><br><span class=\"line\">        数据结构是在系统软件级别研究数据的存储和操作 。内存</span><br><span class=\"line\"></span><br><span class=\"line\">        为什么有了编程语言还要学习数据库</span><br><span class=\"line\">       对内存数据操作是编程语言的强项，但是对硬盘数据操作确实编程语言的弱点。</span><br><span class=\"line\">        对硬盘数据操作是数据库的强项，是数据库核心演技的问题</span><br><span class=\"line\">        什么是连接：；</span><br><span class=\"line\">        数据库如何存储数据</span><br><span class=\"line\">                字段 、 记录 表 约束（主键 外键 唯一键 非空 check default  ）</span><br><span class=\"line\">           1.表的相关数据</span><br><span class=\"line\">            字段：</span><br><span class=\"line\">                    一个事务的某一静态特征</span><br><span class=\"line\">            记录</span><br><span class=\"line\">                字段的某一组合 表示的是一个具体的事物</span><br><span class=\"line\">            表</span><br><span class=\"line\">                记录的组合  表示的是同一类型事物集合</span><br><span class=\"line\">               表和字段、记录的关系</span><br><span class=\"line\">                         字段是事物的属性</span><br><span class=\"line\">                         记录是事物本身</span><br><span class=\"line\">                         表是事物的集合</span><br><span class=\"line\">                列 、属性 </span><br><span class=\"line\">                   字段的另一种称谓</span><br><span class=\"line\">                元祖： 记录。</span><br><span class=\"line\">                约束</span><br><span class=\"line\">                对表中属性操作的限制叫做约束。</span><br><span class=\"line\">                分类：</span><br><span class=\"line\">                   主键约束   </span><br><span class=\"line\">                                不允许重复元素，避免数据的冗余</span><br><span class=\"line\">                   外键约束</span><br><span class=\"line\">                                保证关联的其他事务一直存在。</span><br><span class=\"line\">                            check约束</span><br><span class=\"line\">                                        保证事物属性取值在合理发范围之类。</span><br><span class=\"line\">create table student (</span><br><span class=\"line\">        student_id int primary key,</span><br><span class=\"line\">        student_sal int check(student_sal&gt;=5000  and student_sal &lt;=10000)</span><br><span class=\"line\">)</span><br><span class=\"line\">select * from student</span><br><span class=\"line\">insert into student values(1,6000)</span><br><span class=\"line\">//插入报错</span><br><span class=\"line\">insert into student values(1,2000)</span><br><span class=\"line\">违反了PRIMARY KEY 约束&apos;PK__student__2A33069A0F975522&apos;。不能在对象&apos;dbo.student&apos; 中插入重复键。</span><br><span class=\"line\">语句已终止。</span><br><span class=\"line\"></span><br><span class=\"line\">                        default约束</span><br><span class=\"line\">                            保证事物的属性一定会有一个值</span><br><span class=\"line\">                            唯一约束  unquie</span><br><span class=\"line\">                            保证事物的取值不允许重复，但允许一列为null</span><br><span class=\"line\">create table student(</span><br><span class=\"line\">        stu_id int primary key ,</span><br><span class=\"line\">        stu_sal int  check  (stu_sal &gt;2000  and stu_sal&lt;5000 ),</span><br><span class=\"line\">        stu_sex nchar(1) default (&apos;男&apos;),</span><br><span class=\"line\">        stu_name nvarchar(200) unique not null</span><br><span class=\"line\">                                                   )</span><br><span class=\"line\">insert into student values(1,4000,&apos;男&apos;,&apos;张三&apos;)</span><br><span class=\"line\">insert into student values(2,3000,&apos;男&apos;,&apos;黄二&apos;)</span><br><span class=\"line\">insert into student values(3,3000,&apos;男&apos;,&apos;黄二&apos;)   // 违法唯一约束</span><br><span class=\"line\">                                  问题1  unique 键 是否允许多列为空？  sql 只允许一unique 为空。oracle允许多个unique列 为空。</span><br><span class=\"line\">            要注意null  和 default 的区别</span><br><span class=\"line\">            相同点：</span><br><span class=\"line\">                        都允许用户不赋值</span><br><span class=\"line\">            不同点：</span><br><span class=\"line\">                        null 修饰的字段如果用户不赋值，则默认是null</span><br><span class=\"line\">                        default 修饰的字段如果用户不复制默认是defined</span><br><span class=\"line\">  4.  表和约束的区别</span><br><span class=\"line\">                    数据库是通过表来解决事物的存储问题</span><br><span class=\"line\">                    数据库是通过约束来解决事物的取值有效性和合法性问题。</span><br><span class=\"line\">                    建表的过程事物属性和其他事物属性约束的问题。</span><br><span class=\"line\"> 5.   什么是关系</span><br><span class=\"line\">                定义：</span><br><span class=\"line\">                       表和表之间的关系</span><br><span class=\"line\">                实现方式：</span><br><span class=\"line\">                通过设置不同形式的外键来体现表和表不同的关系</span><br><span class=\"line\">                分类：</span><br><span class=\"line\">                一对一  （j假设是A表和B表）</span><br><span class=\"line\">                        既可以把表A的主键充当表B 的外键</span><br><span class=\"line\">                        也可以把表B的主键充当A的外键</span><br><span class=\"line\">                一对多</span><br><span class=\"line\">                        把表A的主键充当B的外键</span><br><span class=\"line\">                       再多的一方添加外键。</span><br><span class=\"line\"></span><br><span class=\"line\">                多对多</span><br><span class=\"line\"></span><br><span class=\"line\">                                                                        </span><br><span class=\"line\">                           </span><br><span class=\"line\"> 数据库如何操作数据的</span><br><span class=\"line\">        insert  update delete t-sql 存储过程 函数  触发器</span><br><span class=\"line\">        数据库如何显示数据</span><br><span class=\"line\">        select  查询  （重点）</span><br><span class=\"line\">            1.计算列：</span><br><span class=\"line\">select ename, sal*12 as &quot;年薪&quot;,sal &quot;月薪&quot; ,job from emp  </span><br><span class=\"line\">                ----as 可以省略记住“年薪”不要写成&apos;年薪&apos;  不要写成年薪    </span><br><span class=\"line\">select  5  from emp            </span><br><span class=\"line\">            --输出的行数是emp表的行数，每行只有一个字段，值是；</span><br><span class=\"line\">            </span><br><span class=\"line\">select 5    --ok</span><br><span class=\"line\">            --不推荐</span><br><span class=\"line\"></span><br><span class=\"line\">2.distinct   （不允许重复的）</span><br><span class=\"line\">select distinct deptno from emp</span><br><span class=\"line\">          select distinct comm from emp    --distinct 可以过略掉重复的空值。  </span><br><span class=\"line\">          select distinct comm ,deptno from emp  -- 把comm 和deptno 的组合进行过</span><br><span class=\"line\">          select deptno, distinct comm  from emp   -- error 逻辑上有冲突</span><br><span class=\"line\">3 .between  </span><br><span class=\"line\">          select *  from emp where sal  between  1500  and 3000</span><br><span class=\"line\">          等价于： </span><br><span class=\"line\">           select *  from emp where (sal &gt;= 1500 and  sal&lt;=3000)</span><br><span class=\"line\"></span><br><span class=\"line\">4 .in  [属于若干个孤立的值]</span><br><span class=\"line\">          select * from emp    where  (sal = 1500 or  sal=3000</span><br><span class=\"line\">             等价于：select * from emp  where sal    in(1500,3000)</span><br><span class=\"line\">        select * from emp  where sal      not   in(1500,3000)  -- sal 不是1500，的值</span><br><span class=\"line\">           等价于：</span><br><span class=\"line\">         select * from emp  where ( sal !=1500  and sal !=3000 and sal !=5000)</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">5.   top   </span><br><span class=\"line\">           select top 5 * from emp</span><br><span class=\"line\">          select top 15 percent * from emp   -- 输出的是三个，不是两个</span><br><span class=\"line\">           select top 5 * from emp where sal between 1500 and   3000  order by sal desc</span><br><span class=\"line\">                                                                                                            -- desc 是降序 asc 是升序</span><br><span class=\"line\"></span><br><span class=\"line\">6.   null   没有值 空值</span><br><span class=\"line\">        零和null 是不一样的，null 表示的空值，没有值，零表示的是一个确定的值。</span><br><span class=\"line\">        null 不能参与如下运算 ： &lt;&gt;  !=   =</span><br><span class=\"line\">        null 可以参与如下运算： is             not is</span><br><span class=\"line\">        任何类型的数据都允许为null</span><br><span class=\"line\">         --输出奖金非空的人员信息</span><br><span class=\"line\">              select * from emp where comm  &lt;&gt;  null  -- 输出为空 error</span><br><span class=\"line\">              select * from emp where comm !=null     -- 输出为空 error</span><br><span class=\"line\">              select * from emp where comm  is   null</span><br><span class=\"line\">              select * from emp where comm  is  not null</span><br><span class=\"line\">              select * from emp where ename=&apos;SMITH&apos;</span><br><span class=\"line\">              --输出一年的奖金</span><br><span class=\"line\">            任何数字参与null 数学运算的结果是null</span><br><span class=\"line\">             select ename  AS 姓名, (sal *12 + ISNULL(comm,0)) as 年薪  from  emp</span><br><span class=\"line\"></span><br><span class=\"line\">7.order by   以某个字段来排序</span><br><span class=\"line\">            </span><br><span class=\"line\">             order by a,  b           --a和b都是升序</span><br><span class=\"line\">              order by a,  b desc   --a升序 b 降序</span><br><span class=\"line\">              order by a desc , b     --a降序b 升序</span><br><span class=\"line\">            文字描述：</span><br><span class=\"line\">                        如果不指定排序的规则，则默认都是升序， 升序用asc 表示 默认可以表示</span><br><span class=\"line\">                select * from emp  order by sal asc  -- 默认升序  可以省略 asc</span><br><span class=\"line\">                   select * from emp  order by sal desc  -- 降序</span><br><span class=\"line\">                  select * from emp  order by deptno,sal     -- 先按部门排序  再按工资排序  </span><br><span class=\"line\"></span><br><span class=\"line\">8.模糊查询    </span><br><span class=\"line\">            格式：</span><br><span class=\"line\">select  字段集合  from 表名 where 字段  like  字段通配符</span><br><span class=\"line\">通配符：%  _[a,f]   _[^a,f]</span><br><span class=\"line\">                      select * from emp where ename like &apos;%A%&apos;  -- 只要含有字母    A 的就输出</span><br><span class=\"line\">                         select * from emp where ename like &apos;A%&apos;  -- 只要首字母是A的就输出    </span><br><span class=\"line\">                         select * from emp where ename like &apos;%A&apos;    -- 只要尾字母是A的就输出</span><br><span class=\"line\">        </span><br><span class=\"line\">               -- 寻找查询%</span><br><span class=\"line\">               select * from student where ename like &apos;%\\%%&apos; escape &apos;\\&apos;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">                      select * from emp where ename like &apos;_A%&apos; --只要第二个子母是A的就输出</span><br><span class=\"line\">                         select * from emp where ename like &apos;_[A-F]%&apos;  --只要第二个子母是a or b or c or d or e or f输出</span><br><span class=\"line\">                         select * from emp where ename like &apos;_[^A-F]%&apos; --只要第二个子母不是a or b or c or d or e or f输出</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">9  聚合函数</span><br><span class=\"line\">        函数分类</span><br><span class=\"line\">                单行函数</span><br><span class=\"line\">                每一行返回一个值</span><br><span class=\"line\"></span><br><span class=\"line\">                多行函数</span><br><span class=\"line\">                多行返回一个值</span><br><span class=\"line\">                聚合函数 是多行函数</span><br><span class=\"line\">                聚合函数的分类</span><br><span class=\"line\">                        max();</span><br><span class=\"line\">                        min();</span><br><span class=\"line\">                        avg();</span><br><span class=\"line\">                        count()</span><br><span class=\"line\">                                count(*)</span><br><span class=\"line\">                                    返回表中的所有有效数据</span><br><span class=\"line\">                                        select  COUNT(*)  from emp</span><br><span class=\"line\">                                 count(字段名)</span><br><span class=\"line\">                                        返回字段非空记录的个数 ，重复的记录也会被当初有效的记录</span><br><span class=\"line\">    select  COUNT(deptno)  from emp</span><br><span class=\"line\">    select  COUNT(comm)  from emp             --comm 为空的记录不会当作有效的记录</span><br><span class=\"line\">                                  count(distinct  字段名)</span><br><span class=\"line\">                                        返回字段不重复且非空的个数</span><br><span class=\"line\">                                       </span><br><span class=\"line\">select  COUNT(distinct deptno) from emp      --统计deptno 不重复的记录个数</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":[]}